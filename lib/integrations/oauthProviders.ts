export type LocalhostOAuthStrategy =
  | "loopback" // http://localhost or http://127.0.0.1
  | "https-localhost" // https://localhost with local cert
  | "tunnel" // ngrok / cloudflared
  | "device-flow" // OAuth device authorization flow
  | "service-account"; // non-user OAuth alternative

export type OAuthProvider = {
  id: string;
  name: string;

  authUrl: string;
  tokenUrl: string;


  scopes: string[];
  scopeSeparator?: " " | ",";

  supportsRefreshToken: boolean;

  extraAuthParams?: Record<string, string>;

  localhostStrategy: LocalhostOAuthStrategy;
  requiresHttps?: boolean;
};

export const OAUTH_PROVIDERS: Record<string, OAuthProvider> = {
  // --- Payments & Finance ---
  stripe: {
    id: "stripe",
    name: "Stripe",
    authUrl: "https://connect.stripe.com/oauth/authorize",
    tokenUrl: "https://connect.stripe.com/oauth/token",
    scopes: ["read_write"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  paypal: {
    id: "paypal",
    name: "PayPal",
    authUrl: "https://www.paypal.com/signin/authorize",
    tokenUrl: "https://api-m.paypal.com/v1/oauth2/token",
    scopes: ["openid", "profile", "email", "https://uri.paypal.com/services/invoicing"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback", // PayPal supports localhost
  },
  square: {
    id: "square",
    name: "Square",
    authUrl: "https://squareup.com/oauth2/authorize",
    tokenUrl: "https://connect.squareup.com/oauth2/token",
    scopes: ["MERCHANT_PROFILE_READ", "PAYMENTS_READ", "CUSTOMERS_READ"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  paddle: {
    id: "paddle",
    name: "Paddle",
    authUrl: "https://login.paddle.com/oauth/authorize",
    tokenUrl: "https://login.paddle.com/oauth/token",
    scopes: ["reports:read", "customers:read"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  chargebee: {
    id: "chargebee",
    name: "Chargebee",
    authUrl: "https://admin.chargebee.com/oauth/authorize",
    tokenUrl: "https://admin.chargebee.com/oauth/token",
    scopes: ["read_only"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },

  // --- Analytics & Events ---
  ga4: {
    id: "ga4",
    name: "Google Analytics 4",
    authUrl: "https://accounts.google.com/o/oauth2/v2/auth",
    tokenUrl: "https://oauth2.googleapis.com/token",
    scopes: ["https://www.googleapis.com/auth/analytics.readonly"],
    supportsRefreshToken: true,
    extraAuthParams: { access_type: "offline", prompt: "consent" },
    localhostStrategy: "loopback",
  },
  google_analytics: {
    id: "google_analytics",
    name: "Google Analytics 4",
    authUrl: "https://accounts.google.com/o/oauth2/v2/auth",
    tokenUrl: "https://oauth2.googleapis.com/token",
    scopes: ["https://www.googleapis.com/auth/analytics.readonly"],
    supportsRefreshToken: true,
    extraAuthParams: { access_type: "offline", prompt: "consent" },
    localhostStrategy: "loopback",
  },
  mixpanel: {
    id: "mixpanel",
    name: "Mixpanel",
    authUrl: "https://mixpanel.com/oauth/authorize",
    tokenUrl: "https://mixpanel.com/oauth/access_token",
    scopes: ["read"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  amplitude: {
    id: "amplitude",
    name: "Amplitude",
    authUrl: "https://amplitude.com/oauth/authorize",
    tokenUrl: "https://amplitude.com/oauth/token",
    scopes: ["read"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  segment: {
    id: "segment",
    name: "Segment",
    authUrl: "https://segment.com/oauth/authorize",
    tokenUrl: "https://segment.com/oauth/token",
    scopes: ["workspace:read"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },

  // --- CRM & Support ---
  hubspot: {
    id: "hubspot",
    name: "HubSpot",
    authUrl: "https://app.hubspot.com/oauth/authorize",
    tokenUrl: "https://api.hubapi.com/oauth/v1/token",
    scopes: ["crm.objects.contacts.read", "crm.objects.companies.read", "crm.objects.deals.read"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback", // HubSpot supports localhost
  },
  salesforce: {
    id: "salesforce",
    name: "Salesforce",
    authUrl: "https://login.salesforce.com/services/oauth2/authorize",
    tokenUrl: "https://login.salesforce.com/services/oauth2/token",
    scopes: ["api", "refresh_token", "offline_access"],
    supportsRefreshToken: true,
    localhostStrategy: "tunnel", // Often requires https
    requiresHttps: true,
  },
  zoho_crm: {
    id: "zoho_crm",
    name: "Zoho CRM",
    authUrl: "https://accounts.zoho.com/oauth/v2/auth",
    tokenUrl: "https://accounts.zoho.com/oauth/v2/token",
    scopes: ["ZohoCRM.modules.ALL"],
    supportsRefreshToken: true,
    extraAuthParams: { access_type: "offline", prompt: "consent" },
    localhostStrategy: "loopback",
  },
  pipedrive: {
    id: "pipedrive",
    name: "Pipedrive",
    authUrl: "https://oauth.pipedrive.com/oauth/authorize",
    tokenUrl: "https://oauth.pipedrive.com/oauth/token",
    scopes: ["deals:read", "contacts:read"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  intercom: {
    id: "intercom",
    name: "Intercom",
    authUrl: "https://app.intercom.com/oauth",
    tokenUrl: "https://api.intercom.io/auth/eagle/token",
    scopes: [],
    supportsRefreshToken: false,
    localhostStrategy: "loopback",
  },
  zendesk: {
    id: "zendesk",
    name: "Zendesk",
    authUrl: "https://global.zendesk.com/oauth/authorizations/new",
    tokenUrl: "https://global.zendesk.com/oauth/tokens",
    scopes: ["read"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  freshdesk: {
    id: "freshdesk",
    name: "Freshdesk",
    authUrl: "https://freshdesk.com/oauth/authorize",
    tokenUrl: "https://freshdesk.com/oauth/token",
    scopes: ["read"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },

  // --- Marketing & Growth ---
  google_ads: {
    id: "google_ads",
    name: "Google Ads",
    authUrl: "https://accounts.google.com/o/oauth2/v2/auth",
    tokenUrl: "https://oauth2.googleapis.com/token",
    scopes: ["https://www.googleapis.com/auth/adwords"],
    supportsRefreshToken: true,
    extraAuthParams: { access_type: "offline", prompt: "consent" },
    localhostStrategy: "loopback",
  },
  meta_ads: {
    id: "meta_ads",
    name: "Meta Ads",
    authUrl: "https://www.facebook.com/v18.0/dialog/oauth",
    tokenUrl: "https://graph.facebook.com/v18.0/oauth/access_token",
    scopes: ["ads_read", "ads_management"],
    supportsRefreshToken: true,
    localhostStrategy: "tunnel", // Meta strictly enforces https
    requiresHttps: true,
  },
  linkedin_ads: {
    id: "linkedin_ads",
    name: "LinkedIn Ads",
    authUrl: "https://www.linkedin.com/oauth/v2/authorization",
    tokenUrl: "https://www.linkedin.com/oauth/v2/accessToken",
    scopes: ["r_ads", "r_ads_reporting"],
    supportsRefreshToken: true,
    localhostStrategy: "tunnel", // LinkedIn often requires public URLs or strict https
  },
  tiktok_ads: {
    id: "tiktok_ads",
    name: "TikTok Ads",
    authUrl: "https://ads.tiktok.com/marketing_api/auth",
    tokenUrl: "https://ads.tiktok.com/open_api/v1.3/oauth2/access_token/",
    scopes: ["ads.read"],
    supportsRefreshToken: true,
    localhostStrategy: "tunnel",
    requiresHttps: true,
  },
  mailchimp: {
    id: "mailchimp",
    name: "Mailchimp",
    authUrl: "https://login.mailchimp.com/oauth2/authorize",
    tokenUrl: "https://login.mailchimp.com/oauth2/token",
    scopes: [],
    supportsRefreshToken: false,
    localhostStrategy: "loopback",
  },
  klaviyo: {
    id: "klaviyo",
    name: "Klaviyo",
    authUrl: "https://www.klaviyo.com/oauth/authorize",
    tokenUrl: "https://www.klaviyo.com/oauth/token",
    scopes: ["campaigns:read", "metrics:read"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  customer_io: {
    id: "customer_io",
    name: "Customer.io",
    authUrl: "https://fly.customer.io/oauth/authorize",
    tokenUrl: "https://fly.customer.io/oauth/token",
    scopes: ["read"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },

  // --- Developer & Engineering ---
  github: {
    id: "github",
    name: "GitHub",
    authUrl: "https://github.com/login/oauth/authorize",
    tokenUrl: "https://github.com/login/oauth/access_token",
    scopes: ["repo", "user"],
    supportsRefreshToken: false,
    localhostStrategy: "loopback",
  },
  gitlab: {
    id: "gitlab",
    name: "GitLab",
    authUrl: "https://gitlab.com/oauth/authorize",
    tokenUrl: "https://gitlab.com/oauth/token",
    scopes: ["api"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  bitbucket: {
    id: "bitbucket",
    name: "Bitbucket",
    authUrl: "https://bitbucket.org/site/oauth2/authorize",
    tokenUrl: "https://bitbucket.org/site/oauth2/access_token",
    scopes: ["repository", "account"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  jira: {
    id: "jira",
    name: "Jira",
    authUrl: "https://auth.atlassian.com/authorize",
    tokenUrl: "https://auth.atlassian.com/oauth/token",
    scopes: ["read:jira-work", "offline_access"],
    supportsRefreshToken: true,
    extraAuthParams: { audience: "api.atlassian.com", prompt: "consent" },
    localhostStrategy: "loopback",
  },
  linear: {
    id: "linear",
    name: "Linear",
    authUrl: "https://linear.app/oauth/authorize",
    tokenUrl: "https://api.linear.app/oauth/token",
    scopes: ["read"],
    supportsRefreshToken: false,
    localhostStrategy: "loopback",
  },
  asana: {
    id: "asana",
    name: "Asana",
    authUrl: "https://app.asana.com/-/oauth_authorize",
    tokenUrl: "https://app.asana.com/-/oauth_token",
    scopes: ["default"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  clickup: {
    id: "clickup",
    name: "ClickUp",
    authUrl: "https://app.clickup.com/api",
    tokenUrl: "https://api.clickup.com/api/v2/oauth/token",
    scopes: [],
    supportsRefreshToken: false,
    localhostStrategy: "loopback",
  },
  sentry: {
    id: "sentry",
    name: "Sentry",
    authUrl: "https://sentry.io/oauth/authorize/",
    tokenUrl: "https://sentry.io/oauth/token/",
    scopes: ["project:read", "event:read", "org:read"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  datadog: {
    id: "datadog",
    name: "Datadog",
    authUrl: "https://app.datadoghq.com/oauth2/v1/authorize",
    tokenUrl: "https://app.datadoghq.com/oauth2/v1/token",
    scopes: [],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  new_relic: {
    id: "new_relic",
    name: "New Relic",
    authUrl: "https://oauth.newrelic.com/login",
    tokenUrl: "https://oauth.newrelic.com/token",
    scopes: [],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },

  // --- Cloud & Infra ---
  aws: {
    id: "aws",
    name: "AWS",
    authUrl: "https://signin.aws.amazon.com/oauth",
    tokenUrl: "https://signin.aws.amazon.com/token",
    scopes: [],
    supportsRefreshToken: true,
    localhostStrategy: "service-account", // AWS usually uses IAM keys directly
  },
  gcp: {
    id: "gcp",
    name: "GCP",
    authUrl: "https://accounts.google.com/o/oauth2/v2/auth",
    tokenUrl: "https://oauth2.googleapis.com/token",
    scopes: ["https://www.googleapis.com/auth/cloud-platform.read-only"],
    supportsRefreshToken: true,
    extraAuthParams: { access_type: "offline", prompt: "consent" },
    localhostStrategy: "loopback",
  },
  azure: {
    id: "azure",
    name: "Azure",
    authUrl: "https://login.microsoftonline.com/common/oauth2/v2.0/authorize",
    tokenUrl: "https://login.microsoftonline.com/common/oauth2/v2.0/token",
    scopes: ["https://management.azure.com/.default", "offline_access"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback", // MSAL works with http://localhost
  },
  vercel: {
    id: "vercel",
    name: "Vercel",
    authUrl: "https://vercel.com/oauth/authorize",
    tokenUrl: "https://api.vercel.com/v2/oauth/access_token",
    scopes: [],
    supportsRefreshToken: false,
    localhostStrategy: "loopback",
  },
  netlify: {
    id: "netlify",
    name: "Netlify",
    authUrl: "https://app.netlify.com/authorize",
    tokenUrl: "https://api.netlify.com/oauth/token",
    scopes: [],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  render: {
    id: "render",
    name: "Render",
    authUrl: "https://api.render.com/oauth/authorize",
    tokenUrl: "https://api.render.com/oauth/token",
    scopes: ["read"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },

  // --- Files & Knowledge ---
  google_drive: {
    id: "google_drive",
    name: "Google Drive",
    authUrl: "https://accounts.google.com/o/oauth2/v2/auth",
    tokenUrl: "https://oauth2.googleapis.com/token",
    scopes: ["https://www.googleapis.com/auth/drive.readonly"],
    supportsRefreshToken: true,
    extraAuthParams: { access_type: "offline", prompt: "consent" },
    localhostStrategy: "loopback",
  },
  google_sheets: {
    id: "google_sheets",
    name: "Google Sheets",
    authUrl: "https://accounts.google.com/o/oauth2/v2/auth",
    tokenUrl: "https://oauth2.googleapis.com/token",
    scopes: ["https://www.googleapis.com/auth/spreadsheets.readonly"],
    supportsRefreshToken: true,
    extraAuthParams: { access_type: "offline", prompt: "consent" },
    localhostStrategy: "loopback",
  },
  airtable: {
    id: "airtable",
    name: "Airtable",
    authUrl: "https://airtable.com/oauth2/v1/authorize",
    tokenUrl: "https://airtable.com/oauth2/v1/token",
    scopes: ["data.records:read", "schema.bases:read"],
    supportsRefreshToken: true,
    extraAuthParams: { code_challenge_method: "S256" },
    localhostStrategy: "loopback",
  },
  notion: {
    id: "notion",
    name: "Notion",
    authUrl: "https://api.notion.com/v1/oauth/authorize",
    tokenUrl: "https://api.notion.com/v1/oauth/token",
    scopes: [],
    supportsRefreshToken: false,
    localhostStrategy: "loopback",
  },
  confluence: {
    id: "confluence",
    name: "Confluence",
    authUrl: "https://auth.atlassian.com/authorize",
    tokenUrl: "https://auth.atlassian.com/oauth/token",
    scopes: ["read:confluence-content.all", "offline_access"],
    supportsRefreshToken: true,
    extraAuthParams: { audience: "api.atlassian.com", prompt: "consent" },
    localhostStrategy: "loopback",
  },
  dropbox: {
    id: "dropbox",
    name: "Dropbox",
    authUrl: "https://www.dropbox.com/oauth2/authorize",
    tokenUrl: "https://api.dropbox.com/oauth2/token",
    scopes: ["files.content.read", "sharing.read"],
    supportsRefreshToken: true,
    extraAuthParams: { token_access_type: "offline" },
    localhostStrategy: "loopback",
  },
  box: {
    id: "box",
    name: "Box",
    authUrl: "https://account.box.com/api/oauth2/authorize",
    tokenUrl: "https://api.box.com/oauth2/token",
    scopes: [],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },

  // --- Identity & HR ---
  okta: {
    id: "okta",
    name: "Okta",
    authUrl: "https://{yourOktaDomain}/oauth2/v1/authorize",
    tokenUrl: "https://{yourOktaDomain}/oauth2/v1/token",
    scopes: ["openid", "profile", "email"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  azure_ad: {
    id: "azure_ad",
    name: "Azure AD",
    authUrl: "https://login.microsoftonline.com/common/oauth2/v2.0/authorize",
    tokenUrl: "https://login.microsoftonline.com/common/oauth2/v2.0/token",
    scopes: ["User.Read", "Directory.Read.All", "offline_access"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  google_workspace: {
    id: "google_workspace",
    name: "Google Workspace",
    authUrl: "https://accounts.google.com/o/oauth2/v2/auth",
    tokenUrl: "https://oauth2.googleapis.com/token",
    scopes: ["https://www.googleapis.com/auth/admin.directory.user.readonly"],
    supportsRefreshToken: true,
    extraAuthParams: { access_type: "offline", prompt: "consent" },
    localhostStrategy: "loopback",
  },
  rippling: {
    id: "rippling",
    name: "Rippling",
    authUrl: "https://app.rippling.com/oauth/authorize",
    tokenUrl: "https://app.rippling.com/oauth/token",
    scopes: [],
    supportsRefreshToken: true,
    localhostStrategy: "tunnel",
    requiresHttps: true,
  },
  bamboohr: {
    id: "bamboohr",
    name: "BambooHR",
    authUrl: "https://api.bamboohr.com/oauth/authorize",
    tokenUrl: "https://api.bamboohr.com/oauth/token",
    scopes: [],
    supportsRefreshToken: false,
    localhostStrategy: "loopback",
  },
  deel: {
    id: "deel",
    name: "Deel",
    authUrl: "https://app.deel.com/oauth2/authorize",
    tokenUrl: "https://api.deel.com/oauth2/token",
    scopes: ["contracts:read", "people:read"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  workday: {
    id: "workday",
    name: "Workday",
    authUrl: "https://impl.workday.com/oauth2/authorize",
    tokenUrl: "https://impl.workday.com/oauth2/token",
    scopes: [],
    supportsRefreshToken: true,
    localhostStrategy: "tunnel", // Often requires https
    requiresHttps: true,
  },

  // --- Messaging & Actions ---
  slack: {
    id: "slack",
    name: "Slack",
    authUrl: "https://slack.com/oauth/v2/authorize",
    tokenUrl: "https://slack.com/api/oauth.v2.access",
    scopes: ["channels:read", "chat:write", "files:read"],
    supportsRefreshToken: false,
    localhostStrategy: "loopback",
  },
  teams: {
    id: "teams",
    name: "Microsoft Teams",
    authUrl: "https://login.microsoftonline.com/common/oauth2/v2.0/authorize",
    tokenUrl: "https://login.microsoftonline.com/common/oauth2/v2.0/token",
    scopes: ["Channel.ReadBasic.All", "ChatMessage.Read.All", "offline_access"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  discord: {
    id: "discord",
    name: "Discord",
    authUrl: "https://discord.com/api/oauth2/authorize",
    tokenUrl: "https://discord.com/api/oauth2/token",
    scopes: ["identify", "guilds"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
  pagerduty: {
    id: "pagerduty",
    name: "PagerDuty",
    authUrl: "https://app.pagerduty.com/oauth/authorize",
    tokenUrl: "https://app.pagerduty.com/oauth/token",
    scopes: ["read"],
    supportsRefreshToken: false,
    localhostStrategy: "loopback",
  },

  whatsapp: {
    id: "whatsapp",
    name: "WhatsApp",
    authUrl: "https://www.facebook.com/v18.0/dialog/oauth",
    tokenUrl: "https://graph.facebook.com/v18.0/oauth/access_token",
    scopes: ["whatsapp_business_messaging", "whatsapp_business_management"],
    supportsRefreshToken: true,
    localhostStrategy: "tunnel", // Meta enforces https
    requiresHttps: true,
  },

  // --- AI Providers ---
  azure_openai: {
    id: "azure_openai",
    name: "Azure OpenAI",
    authUrl: "https://login.microsoftonline.com/common/oauth2/v2.0/authorize",
    tokenUrl: "https://login.microsoftonline.com/common/oauth2/v2.0/token",
    scopes: ["https://cognitiveservices.azure.com/.default", "offline_access"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },

  huggingface: {
    id: "huggingface",
    name: "HuggingFace",
    authUrl: "https://huggingface.co/oauth/authorize",
    tokenUrl: "https://huggingface.co/oauth/token",
    scopes: ["inference-api"],
    supportsRefreshToken: true,
    localhostStrategy: "loopback",
  },
};
